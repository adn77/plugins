{% if helpers.exists('OPNsense.netsnmp.trapd.enabled') and OPNsense.netsnmp.trapd.enabled == '1' %}
{%   if helpers.exists('OPNsense.netsnmp.trapd.community') and OPNsense.netsnmp.trapd.community != '' %}
authCommunity log,execute,net {{ OPNsense.netsnmp.trapd.community }}
{%   endif %}
{%   if helpers.exists('OPNsense.netsnmp.trapd.traptomail') and OPNsense.netsnmp.trapd.traptomail == '1' %}
{%     if helpers.exists('OPNsense.netsnmp.trapd.mailserver') and OPNsense.netsnmp.trapd.mailserver != ''
 and helpers.exists('OPNsense.netsnmp.trapd.mailto') and OPNsense.netsnmp.trapd.mailto != ''
 and helpers.exists('OPNsense.netsnmp.trapd.mailfrom') and OPNsense.netsnmp.trapd.mailfrom != '' %}
traphandle default /usr/local/opnsense/scripts/OPNsense/Netsnmp/traptoemail.sh -s {{ OPNsense.netsnmp.trapd.mailserver }} -f {{ OPNsense.netsnmp.trapd.mailfrom }} {{ OPNsense.netsnmp.trapd.mailto }}
{%     endif %}
{%   endif %}
{% endif %}
format1 %.4y-%.2m-%.2l %.2h:%.2j:%.2k %B [%b]: %N\n\t%W Trap (%q) Uptime: %#T\n%v\n
format execute %q\n%A\n Date: %.4y-%.2m-%.2l %.2h:%.2j:%.2k \n Agent Address: %A \n Enterprise OID: %N \n Trap Type: %W \n Trap Sub-Type: %q \n Community/Infosec Context: %P \n Uptime: %#T \n Description: %W \n PDU Attribute/Value Pair Array:\n%V\n% %v \n -------------- \n
